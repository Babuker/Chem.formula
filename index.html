<!DOCTYPE html>
<html lang="en" dir="ltr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chemical Formula Optimizer - AI-Powered Formulation Design</title>
    
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    
    <!-- CSS -->
    <link rel="stylesheet" href="style.css">
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="manifest.json">
    
    <style>
        /* Language Switcher */
        .lang-switcher {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
        }
        
        .lang-btn {
            background: linear-gradient(135deg, #2c3e50, #3498db);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 25px;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 8px;
            font-weight: 600;
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
            transition: all 0.3s ease;
        }
        
        .lang-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.3);
        }
        
        /* Toast Styles */
        .toast {
            position: fixed;
            bottom: 30px;
            right: 30px;
            background: #333;
            color: white;
            padding: 15px 25px;
            border-radius: 8px;
            box-shadow: 0 8px 24px rgba(0,0,0,0.15);
            z-index: 10000;
            opacity: 0;
            transform: translateY(100px);
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            gap: 10px;
            max-width: 400px;
        }
        
        .toast.show {
            opacity: 1;
            transform: translateY(0);
        }
        
        .toast.success {
            background: linear-gradient(135deg, #27ae60, #219653);
        }
        
        .toast.error {
            background: linear-gradient(135deg, #e74c3c, #c0392b);
        }
        
        .toast.info {
            background: linear-gradient(135deg, #3498db, #2980b9);
        }
        
        .toast.warning {
            background: linear-gradient(135deg, #f39c12, #e67e22);
        }
        
        .toast i {
            font-size: 1.2rem;
        }
    </style>
</head>
<body>
    <!-- Language Switcher -->
    <div class="lang-switcher">
        <button class="lang-btn" onclick="window.location.href='index-ar.html'">
            <i class="fas fa-language"></i>
            العربية
        </button>
    </div>

    <!-- Header -->
    <header>
        <div class="container">
            <div class="header-content">
                <div class="logo">
                    <i class="fas fa-atom"></i>
                    <div class="logo-text">
                        <h1>Chemical Formula Optimizer</h1>
                        <p>AI-Powered Optimal Formulation Design with Economic Considerations</p>
                    </div>
                </div>
                <nav>
                    <ul>
                        <li><a href="#"><i class="fas fa-home"></i> Home</a></li>
                        <li><a href="#"><i class="fas fa-book"></i> Documentation</a></li>
                        <li><a href="#"><i class="fas fa-database"></i> Database</a></li>
                        <li><a href="#"><i class="fas fa-envelope"></i> Contact</a></li>
                    </ul>
                </nav>
            </div>
        </div>
    </header>
    
    <div class="container">
        <div class="main-content">
            <!-- Form Section -->
            <section class="form-section">
                <div class="section-title">
                    <i class="fas fa-sliders-h"></i>
                    <h2>Design Settings</h2>
                </div>
                
                <form id="formulaForm">
                    <!-- Basic Information Section -->
                    <div class="basic-info-section">
                        <div class="section-title" style="border: none; padding: 0; margin: 0 0 15px 0;">
                            <i class="fas fa-info-circle"></i>
                            <h3 style="font-size: 1.2rem;">Basic Information</h3>
                        </div>
                        
                        <div class="form-group">
                            <label for="formulaName"><i class="fas fa-tag"></i> Formula Name</label>
                            <input type="text" id="formulaName" placeholder="e.g., Paracetamol 500mg - High Concentration" value="Paracetamol 500mg Tablet" required>
                        </div>
                        
                        <div class="form-group">
                            <label><i class="fas fa-book-medical"></i> Pharmacopeia Reference</label>
                            <div class="reference-badges">
                                <div class="reference-badge bp active" data-reference="bp">
                                    <i class="fas fa-flag-uk"></i> British Pharmacopoeia (BP)
                                </div>
                                <div class="reference-badge usp" data-reference="usp">
                                    <i class="fas fa-flag-usa"></i> United States Pharmacopeia (USP)
                                </div>
                            </div>
                            <input type="hidden" id="reference" value="bp" required>
                        </div>
                        
                        <div class="form-group">
                            <label><i class="fas fa-pills"></i> Required Product Form</label>
                            <div class="product-form-options">
                                <div class="product-form-option active" data-form="tablet-uncoated">
                                    <i class="fas fa-tablet-alt"></i>
                                    <div>Uncoated Tablet</div>
                                    <small>Direct Compression</small>
                                </div>
                                <div class="product-form-option" data-form="tablet-coated">
                                    <i class="fas fa-tablet-alt"></i>
                                    <div>Coated Tablet</div>
                                    <small>Film Coated</small>
                                </div>
                                <div class="product-form-option" data-form="capsule">
                                    <i class="fas fa-capsules"></i>
                                    <div>Capsule</div>
                                    <small>Hard Gelatin</small>
                                </div>
                                <div class="product-form-option" data-form="syrup">
                                    <i class="fas fa-wine-bottle"></i>
                                    <div>Syrup</div>
                                    <small>Oral Solution</small>
                                </div>
                                <div class="product-form-option" data-form="powder">
                                    <i class="fas fa-mortar-pestle"></i>
                                    <div>Powder</div>
                                    <small>Dry Mix</small>
                                </div>
                            </div>
                            <input type="hidden" id="productForm" value="tablet-uncoated" required>
                        </div>
                    </div>
                    
                    <!-- Active Ingredients Section -->
                    <div class="active-ingredient-section">
                        <div class="section-title" style="border: none; padding: 0; margin: 0 0 15px 0;">
                            <i class="fas fa-vial"></i>
                            <h3 style="font-size: 1.2rem;">Active Ingredient(s)</h3>
                        </div>
                        
                        <div id="activeIngredientsContainer">
                            <!-- First ingredient row -->
                            <div class="ingredient-row">
                                <select class="active-ingredient" required>
                                    <option value="">Select Active Ingredient...</option>
                                    <option value="paracetamol" selected>Paracetamol (Acetaminophen)</option>
                                    <option value="ibuprofen">Ibuprofen</option>
                                    <option value="amoxicillin">Amoxicillin</option>
                                    <option value="silver-iodide">Silver Iodide</option>
                                    <option value="titanium-dioxide">Titanium Dioxide (TiO₂)</option>
                                    <option value="sodium-hypochlorite">Sodium Hypochlorite (NaClO)</option>
                                    <option value="vitamin-c">Vitamin C (Ascorbic Acid)</option>
                                </select>
                                
                                <div class="input-with-unit">
                                    <input type="number" class="active-ingredient-amount" min="1" max="10000" step="0.1" value="500" required>
                                    <div class="unit">mg</div>
                                </div>
                                
                                <button type="button" class="remove-ingredient" onclick="removeIngredientRow(this)">
                                    <i class="fas fa-times"></i>
                                </button>
                            </div>
                        </div>
                        
                        <button type="button" class="btn btn-secondary" onclick="addIngredientRow()" style="margin-top: 10px;">
                            <i class="fas fa-plus"></i> Add Another Active Ingredient
                        </button>
                        
                        <div class="form-group" style="margin-top: 15px;">
                            <label for="totalWeight"><i class="fas fa-weight"></i> Total Formulation Weight/Volume</label>
                            <div class="input-with-unit">
                                <input type="number" id="totalWeight" min="1" max="10000" step="1" value="1000" required>
                                <div class="unit">mg (per unit)</div>
                            </div>
                            <small style="color: #666; display: block; margin-top: 5px;">Total weight of final formulation (per tablet, capsule, ml, etc.)</small>
                        </div>
                    </div>
                    
                    <!-- Input Method Section -->
                    <div class="input-method-section">
                        <div class="section-title" style="border: none; padding: 0; margin: 0 0 15px 0;">
                            <i class="fas fa-tools"></i>
                            <h3 style="font-size: 1.2rem;">Excipient Input Method</h3>
                        </div>
                        
                        <div class="input-method-options">
                            <div class="input-method-option" id="manualOption" onclick="selectInputMethod('manual')">
                                <i class="fas fa-hand-pointer"></i>
                                <h4>Manual Selection</h4>
                                <p>Select excipients manually one by one based on your expertise</p>
                                <div style="margin-top: 10px; font-size: 0.8rem; color: #f57c00;">
                                    <i class="fas fa-user-edit"></i> Suitable for Specialists
                                </div>
                            </div>
                            
                            <div class="input-method-option selected" id="autoOption" onclick="selectInputMethod('auto')">
                                <i class="fas fa-robot"></i>
                                <h4>Automatic Input</h4>
                                <p>AI automatically selects excipients based on your criteria</p>
                                <div style="margin-top: 10px; font-size: 0.8rem; color: #388e3c;">
                                    <i class="fas fa-bolt"></i> Fast & Smart
                                </div>
                            </div>
                        </div>
                        <input type="hidden" id="inputMethod" value="auto">
                    </div>
                    
                    <!-- Auto Input Section (Visible by default) -->
                    <div class="auto-input-section" id="autoInputSection" style="display: block;">
                        <div style="margin-bottom: 20px;">
                            <h4 style="color: var(--dark-color); margin-bottom: 10px;">
                                <i class="fas fa-cogs"></i> Automatic Selection Settings
                            </h4>
                            <p style="color: #666; margin-bottom: 15px;">
                                AI will automatically select excipients based on the following criteria:
                            </p>
                            
                            <div class="auto-options">
                                <div class="auto-option">
                                    <h5><i class="fas fa-money-bill-wave"></i> Cost Strategy</h5>
                                    <p>Choose cost priority for excipient selection:</p>
                                    <select id="costStrategy" style="width: 100%; padding: 8px; border-radius: 6px; border: 1px solid #ddd;">
                                        <option value="lowest">Lowest Possible Cost</option>
                                        <option value="balanced" selected>Balance Between Cost & Quality</option>
                                        <option value="premium">Best Quality Regardless of Cost</option>
                                    </select>
                                </div>
                                
                                <div class="auto-option">
                                    <h5><i class="fas fa-industry"></i> Production Strategy</h5>
                                    <p>Choose manufacturing process priority:</p>
                                    <select id="productionStrategy" style="width: 100%; padding: 8px; border-radius: 6px; border: 1px solid #ddd;">
                                        <option value="easy-processing">Easy Processing</option>
                                        <option value="high-speed" selected>High Production Speed</option>
                                        <option value="stability">Stability & Reliability</option>
                                    </select>
                                </div>
                                
                                <div class="auto-option">
                                    <h5><i class="fas fa-leaf"></i> Special Criteria</h5>
                                    <div style="margin-top: 10px;">
                                        <label style="display: flex; align-items: center; gap: 8px; margin-bottom: 8px;">
                                            <input type="checkbox" id="vegetarianCapsules" value="vegetarian">
                                            <span>Vegetarian Capsules (Gelatin-Free)</span>
                                        </label>
                                        <label style="display: flex; align-items: center; gap: 8px; margin-bottom: 8px;">
                                            <input type="checkbox" id="sugarFree" value="sugar-free">
                                            <span>Sugar-Free Formulation</span>
                                        </label>
                                        <label style="display: flex; align-items: center; gap: 8px;">
                                            <input type="checkbox" id="preservativeFree" value="preservative-free">
                                            <span>Preservative-Free</span>
                                        </label>
                                    </div>
                                </div>
                                
                                <div class="auto-option">
                                    <h5><i class="fas fa-bolt"></i> Formulation Performance</h5>
                                    <p>Choose performance priority:</p>
                                    <select id="performancePriority" style="width: 100%; padding: 8px; border-radius: 6px; border: 1px solid #ddd;">
                                        <option value="fast-release">Fast Release</option>
                                        <option value="sustained-release" selected>Sustained Release</option>
                                        <option value="targeted-release">Targeted Release</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        
                        <div>
                            <h5 style="color: var(--dark-color); margin-bottom: 10px;">
                                <i class="fas fa-eye"></i> Suggested Excipients Preview
                            </h5>
                            
                            <div style="background-color: white; padding: 15px; border-radius: 8px; border: 1px solid #c8e6c9;">
                                <p style="margin-bottom: 10px; color: #666;">
                                    Based on your settings, AI will select the following excipients:
                                </p>
                                
                                <div class="auto-excipients-preview" id="autoExcipientsPreview">
                                    <div class="auto-excipient-tag">Microcrystalline Cellulose</div>
                                    <div class="auto-excipient-tag">Povidone</div>
                                    <div class="auto-excipient-tag">Croscarmellose</div>
                                    <div class="auto-excipient-tag">Magnesium Stearate</div>
                                </div>
                                
                                <div style="margin-top: 15px; text-align: center;">
                                    <button type="button" class="btn btn-secondary" onclick="regenerateAutoSuggestions()" style="padding: 8px 20px;">
                                        <i class="fas fa-sync-alt"></i> Regenerate Suggestions
                                    </button>
                                </div>
                            </div>
                        </div>
                        
                        <div style="margin-top: 15px; background-color: #e3f2fd; padding: 12px; border-radius: 8px;">
                            <p style="margin: 0; color: #1565c0; font-size: 0.9rem;">
                                <i class="fas fa-lightbulb"></i> 
                                <strong>Tip:</strong> AI analyzes over 1000 formulations to select the best excipients based on your criteria.
                            </p>
                        </div>
                    </div>
                    
                    <!-- Additional Settings -->
                    <div class="form-group">
                        <label for="primaryGoal"><i class="fas fa-bullseye"></i> Primary Design Goal</label>
                        <select id="primaryGoal" required>
                            <option value="">Select Primary Goal...</option>
                            <option value="min-cost">Minimum Cost</option>
                            <option value="max-performance">Maximum Performance</option>
                            <option value="balanced" selected>Balance Between Cost & Performance</option>
                            <option value="fast-production">Fast Production</option>
                            <option value="eco-friendly">Eco-Friendly</option>
                        </select>
                    </div>
                    
                    <div class="form-group">
                        <label for="budget"><i class="fas fa-money-bill-wave"></i> Target Budget</label>
                        <input type="range" id="budget" min="10" max="1000" value="200" step="10">
                        <div style="display: flex; justify-content: space-between; margin-top: 5px;">
                            <span>Low (10)</span>
                            <span id="budgetValue">200</span>
                            <span>High (1000)</span>
                        </div>
                        <small style="color: #666;">Cost per kg of final product</small>
                    </div>
                    
                    <div class="form-group">
                        <label for="notes"><i class="fas fa-sticky-note"></i> Additional Notes</label>
                        <textarea id="notes" placeholder="Any special requirements, sensitivities, prohibited materials, or specific instructions..." rows="3"></textarea>
                    </div>
                    
                    <button type="submit" class="btn" id="calculateBtn">
                        <i class="fas fa-calculator"></i> Design Optimal Formula
                    </button>
                </form>
            </section>
            
            <!-- Results Section -->
            <section class="results-section">
                <div class="section-title">
                    <i class="fas fa-chart-line"></i>
                    <h2>Results & Optimal Formula</h2>
                </div>
                
                <div id="resultsPlaceholder" class="results-placeholder">
                    <i class="fas fa-search"></i>
                    <h3>Results Will Appear Here</h3>
                    <p>Fill out the form on the left then click "Design Optimal Formula"</p>
                    <div style="margin-top: 20px; color: #666; max-width: 400px;">
                        <small>AI will analyze over 1000 possible formulations to find the best based on your criteria</small>
                    </div>
                </div>
                
                <!-- Main Results Section -->
                <div id="resultsContent" class="results-content" style="display: none;">
                    <div class="formula-header">
                        <div>
                            <div class="formula-name-display" id="formulaNameDisplay">Paracetamol 500mg</div>
                            <div class="formula-meta">
                                <span class="meta-badge reference bp" id="referenceBadge">BP</span>
                                <span class="meta-badge form" id="formBadge">Uncoated Tablet</span>
                                <span><i class="far fa-calendar"></i> Design Date: <span id="designDate">2024-01-17</span></span>
                            </div>
                        </div>
                        <div class="cost-badge" id="totalCost">$0.42/per 1000 tablets</div>
                    </div>
                    
                    <div class="formula-details">
                        <h4><i class="fas fa-list-alt"></i> Optimal Formula Components:</h4>
                        <div class="table-container">
                            <table class="formula-table" id="formulaTable">
                                <thead>
                                    <tr>
                                        <th>Component</th>
                                        <th>Amount/Percentage</th>
                                        <th>Function</th>
                                        <th>Cost</th>
                                        <th>Reference</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <!-- Will be populated by JavaScript -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                    
                    <div class="formula-details">
                        <h4><i class="fas fa-chart-pie"></i> Percentage Distribution</h4>
                        <div style="max-width: 500px; margin: 20px auto;">
                            <canvas id="formulaChart"></canvas>
                        </div>
                    </div>
                    
                    <div class="formula-details">
                        <h4><i class="fas fa-award"></i> Quality Specifications (<span id="specsReference">BP</span>):</h4>
                        <div class="table-container">
                            <table class="specifications-table bp" id="specificationsTable">
                                <thead>
                                    <tr>
                                        <th>Test</th>
                                        <th>Specification</th>
                                        <th>Formula Result</th>
                                        <th>Status</th>
                                    </tr>
                                </thead>
                                <tbody id="specificationsBody">
                                    <!-- Will be populated by JavaScript -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                    
                    <div class="performance-metrics" id="performanceMetrics">
                        <!-- Will be populated by JavaScript -->
                    </div>
                    
                    <div style="margin-top: 25px; display: flex; gap: 10px; flex-wrap: wrap;">
                        <button class="btn btn-success" onclick="exportResults()" style="flex: 1; min-width: 200px;">
                            <i class="fas fa-file-export"></i> Export Report
                        </button>
                        <button class="btn" onclick="saveFormula()" style="flex: 1; min-width: 200px; background-color: var(--primary-color);">
                            <i class="fas fa-save"></i> Save Formula
                        </button>
                        <button class="btn btn-info" onclick="printResults()" style="flex: 1; min-width: 200px;">
                            <i class="fas fa-print"></i> Print Results
                        </button>
                    </div>
                </div>
            </section>
        </div>
        
        <!-- Examples Section -->
        <section class="examples-section">
            <div class="section-title">
                <i class="fas fa-vial"></i>
                <h2>Quick Start Examples</h2>
            </div>
            
            <div class="examples-grid">
                <div class="example-card" onclick="loadExample('paracetamol')">
                    <h4><i class="fas fa-tablets"></i> Economic Paracetamol Tablet</h4>
                    <p>Optimal formula for Paracetamol 500mg tablet achieving lowest cost while maintaining quality standards.</p>
                    <div class="example-tags">
                        <span class="tag">Pharmaceutical</span>
                        <span class="tag">Economic</span>
                        <span class="tag">Proven</span>
                    </div>
                </div>
                
                <div class="example-card" onclick="loadExample('cloud-seeding')">
                    <h4><i class="fas fa-cloud-rain"></i> Cloud Seeding Solution</h4>
                    <p>Effective Silver Iodide formulation with carrier materials for rain stimulation at minimum cost.</p>
                    <div class="example-tags">
                        <span class="tag">Climate Engineering</span>
                        <span class="tag">Environmental</span>
                        <span class="tag">Economic</span>
                    </div>
                </div>
                
                <div class="example-card" onclick="loadExample('paint')">
                    <h4><i class="fas fa-paint-roller"></i> Economic Interior Paint</h4>
                    <p>High-quality interior wall paint formulation reducing raw material costs by 22%.</p>
                    <div class="example-tags">
                        <span class="tag">Paints</span>
                        <span class="tag">Cost Saving</span>
                        <span class="tag">High Quality</span>
                    </div>
                </div>
            </div>
        </section>
    </div>
    
    <footer>
        <div class="container">
            <div class="footer-content">
                <div class="footer-logo">
                    <i class="fas fa-atom"></i>
                    <h3>Chemical Formula Optimizer</h3>
                </div>
                
                <div class="disclaimer">
                    <p><i class="fas fa-exclamation-triangle"></i> <strong>Disclaimer:</strong> This tool is for planning and preliminary design purposes only. All results must be verified experimentally and reviewed by qualified chemists before practical application. The software assumes no responsibility for any damages resulting from the use of designed formulations.</p>
                </div>
                
                <p>© 2024 All Rights Reserved | Developed using HTML, CSS, JavaScript</p>
            </div>
        </div>
    </footer>
    
    <!-- JavaScript Libraries -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    
    <!-- Main JavaScript File -->
    <script src="script.js"></script>
    
    <!-- Page-Specific JavaScript -->
    <script>
        // Language switching function
        function switchLanguage(lang) {
            if (lang === 'ar') {
                window.location.href = 'index-ar.html';
            } else {
                window.location.href = 'index.html';
            }
        }
        
        // Example loading function
        function loadExample(example) {
            if (example === 'paracetamol') {
                document.getElementById('formulaName').value = 'Paracetamol 500mg Tablet';
                document.getElementById('reference').value = 'bp';
                document.querySelector('.reference-badge.bp').classList.add('active');
                document.querySelector('.reference-badge.usp').classList.remove('active');
                
                document.getElementById('productForm').value = 'tablet-uncoated';
                document.querySelectorAll('.product-form-option').forEach(opt => opt.classList.remove('active'));
                document.querySelector('.product-form-option[data-form="tablet-uncoated"]').classList.add('active');
                
                document.querySelector('.active-ingredient').value = 'paracetamol';
                document.querySelector('.active-ingredient-amount').value = '500';
                document.getElementById('totalWeight').value = '1000';
                
                document.getElementById('primaryGoal').value = 'min-cost';
                document.getElementById('budget').value = '150';
                document.getElementById('budgetValue').textContent = '150';
                
                showToast('Paracetamol example loaded successfully!', 'success');
            }
        }
        
        // Initialize page when loaded
        document.addEventListener('DOMContentLoaded', function() {
            console.log('Page initialization started...');
            
            // Initialize budget display
            const budgetSlider = document.getElementById('budget');
            const budgetValue = document.getElementById('budgetValue');
            if (budgetSlider && budgetValue) {
                budgetValue.textContent = budgetSlider.value;
                budgetSlider.addEventListener('input', function() {
                    budgetValue.textContent = this.value;
                });
            }
            
            // Initialize form submission
            const formulaForm = document.getElementById('formulaForm');
            if (formulaForm) {
                formulaForm.addEventListener('submit', function(event) {
                    event.preventDefault();
                    console.log('Form submitted!');
                    
                    // Get form values
                    const formulaName = document.getElementById('formulaName').value;
                    const reference = document.getElementById('reference').value;
                    const productForm = document.getElementById('productForm').value;
                    const primaryGoal = document.getElementById('primaryGoal').value;
                    
                    // Get active ingredients
                    const activeIngredients = [];
                    document.querySelectorAll('.ingredient-row').forEach(row => {
                        const name = row.querySelector('.active-ingredient').value;
                        const amount = row.querySelector('.active-ingredient-amount').value;
                        if (name && amount) {
                            activeIngredients.push({ name, amount: parseFloat(amount) });
                        }
                    });
                    
                    // Validate
                    if (!formulaName || !reference || !productForm || !primaryGoal || activeIngredients.length === 0) {
                        showToast('Please fill all required fields', 'error');
                        return;
                    }
                    
                    // Generate auto excipients
                    const excipients = [
                        {
                            name: 'filler',
                            displayName: 'Microcrystalline Cellulose (MCC)',
                            function: 'filler',
                            functionText: 'Filler',
                            percentage: 30
                        },
                        {
                            name: 'binder',
                            displayName: 'Povidone K30',
                            function: 'binder',
                            functionText: 'Binder',
                            percentage: 2
                        },
                        {
                            name: 'disintegrant',
                            displayName: 'Sodium Croscarmellose',
                            function: 'disintegrant',
                            functionText: 'Disintegrant',
                            percentage: 1.5
                        },
                        {
                            name: 'lubricant',
                            displayName: 'Magnesium Stearate',
                            function: 'lubricant',
                            functionText: 'Lubricant',
                            percentage: 0.5
                        }
                    ];
                    
                    // Show results
                    showResults(formulaName, reference, productForm, activeIngredients, excipients);
                });
            }
            
            console.log('Page initialization complete!');
        });
        
        // Simple results display function
        function showResults(formulaName, reference, productForm, activeIngredients, excipients) {
            // Hide placeholder and show results
            document.getElementById('resultsPlaceholder').style.display = 'none';
            document.getElementById('resultsContent').style.display = 'block';
            
            // Update basic info
            document.getElementById('formulaNameDisplay').textContent = formulaName;
            document.getElementById('designDate').textContent = new Date().toLocaleDateString();
            document.getElementById('referenceBadge').textContent = reference.toUpperCase();
            document.getElementById('formBadge').textContent = 'Uncoated Tablet';
            
            // Update formula table
            const tbody = document.querySelector('#formulaTable tbody');
            let html = '';
            
            // Add active ingredients
            activeIngredients.forEach(ing => {
                const ingredientName = ing.name === 'paracetamol' ? 'Paracetamol' : ing.name;
                html += `
                    <tr class="active-ingredient-row">
                        <td>${ingredientName}</td>
                        <td>${ing.amount} mg</td>
                        <td>Active Ingredient</td>
                        <td>$0.00${ing.amount}</td>
                        <td><span class="compliance-badge bp">BP</span></td>
                    </tr>
                `;
            });
            
            // Add excipients
            excipients.forEach(ex => {
                html += `
                    <tr>
                        <td>${ex.displayName}</td>
                        <td>${ex.percentage}%</td>
                        <td>${ex.functionText}</td>
                        <td>$0.0${ex.percentage}</td>
                        <td><span class="compliance-badge bp">BP</span></td>
                    </tr>
                `;
            });
            
            tbody.innerHTML = html;
            
            // Update cost
            document.getElementById('totalCost').textContent = '$0.42/per 1000 tablets';
            
            // Show success message
            showToast('Formula designed successfully!', 'success');
            
            // Scroll to results
            document.getElementById('resultsContent').scrollIntoView({ behavior: 'smooth' });
        }
        
        // Simple toast function
        function showToast(message, type = 'info') {
            // Remove existing toasts
            document.querySelectorAll('.toast').forEach(toast => toast.remove());
            
            const toast = document.createElement('div');
            toast.className = `toast ${type}`;
            toast.innerHTML = `<i class="fas fa-info-circle"></i> ${message}`;
            document.body.appendChild(toast);
            
            setTimeout(() => toast.classList.add('show'), 50);
            setTimeout(() => {
                toast.classList.remove('show');
                setTimeout(() => toast.remove(), 300);
            }, 3000);
        }
    </script>
</body>
</html>
